{% extends "dashboard/base.html" %}
{% block content %}
    <!-- SECTION -->
    <div class="section">
        <!-- container -->
        <div class="container">
            <!-- row -->
            <div class="row justify-content-center">
                <div class="col-md-12">
                    <h2>Search results for "{{ query }}"</h2>
                    <hr>
                </div>
            </div>
            <!-- results row -->
            <div class="row">
                {% if products %}
                    {% for product in products %}
                        <div class="col-md-4 col-xs-6">
                            <div class="product">
                                <div class="product-img">
                                    {% for photo in product.images.all %}
                                        {% if photo.is_main_photo %}<img src="{{ photo.photo.url }}" alt="">{% endif %}
                                    {% endfor %}
                                    <div class="product-label">
                                        {% if product.is_sale %}
                                            <span class="sale">-30%</span>
                                        {% endif %}
                                        {% if product.is_new %}<span class="new">NEW</span>{% endif %}
                                    </div>
                                </div>
                                <div class="product-body">
                                    <p class="product-category">{{ product.category.name }}</p>
                                    <h3 class="product-name">
                                        <a href="{% url 'detail-view' product.id %}">{{ product.name }}</a>
                                    </h3>
                                    <h4 class="product-price">
                                        {{ product.price }}
                                        {% if product.is_sale %}<del class="product-old-price">{{ product.old_price }}</del>{% endif %}
                                    </h4>
                                </div>
                                <div class="add-to-cart">
                                    <form action="{% url 'product-add' %}" method="post">
                                        {% csrf_token %}
                                        <input type="hidden" name="product_id" value="{{ product.id }}">
                                        <button class="add-to-cart-btn" type="submit">
                                            <i class="fa fa-shopping-cart"></i> add to cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="col-md-12">
                        <p>No products found.</p>
                    </div>
                {% endif %}
            </div>
            <!-- Pagination -->
            <div class="store-filter clearfix">
                {% if page_obj.has_other_pages %}
                    <ul class="store-pagination">
                        {% if page_obj.has_previous %}
                            <li>
                                <a href="{% querystring page=page_obj.previous_page_number %}"><i class="fa fa-angle-left"></i></a>
                            </li>
                            <li>
                                <a href="{% querystring page=page_obj.previous_page_number %}">{{ page_obj.previous_page_number }}</a>
                            </li>
                        {% endif %}
                        <li class="active">{{ page_obj.number }}</li>
                        {% if page_obj.has_next %}
                            <li>
                                <a href="{% querystring page=page_obj.next_page_number %}">{{ page_obj.next_page_number }}</a>
                            </li>
                            <li>
                                <a href="{% querystring page=page_obj.next_page_number %}"><i class="fa fa-angle-right"></i></a>
                            </li>
                        {% endif %}
                    </ul>
                {% endif %}
            </div>
        </div>
        <!-- /container -->
    </div>
    <!-- /SECTION -->
{% endblock %}
